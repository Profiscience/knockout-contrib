!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports,require("knockout")):"function"==typeof define&&define.amd?define(["exports","knockout"],e):e((t.ko=t.ko||{},t.ko.router={}),t.ko)}(this,function(t,e){"use strict";function r(t,e,r,n){return new(r||(r=Promise))(function(o,i){function u(t){try{c(n.next(t))}catch(t){i(t)}}function a(t){try{c(n.throw(t))}catch(t){i(t)}}function c(t){t.done?o(t.value):new r(function(e){e(t.value)}).then(u,a)}c((n=n.apply(t,e||[])).next())})}function n(t,e){function r(t){return function(e){return n([t,e])}}function n(r){if(o)throw new TypeError("Generator is already executing.");for(;c;)try{if(o=1,i&&(u=i[2&r[0]?"return":r[0]?"throw":"next"])&&!(u=u.call(i,r[1])).done)return u;switch(i=0,u&&(r=[0,u.value]),r[0]){case 0:case 1:u=r;break;case 4:return c.label++,{value:r[1],done:!1};case 5:c.label++,i=r[1],r=[0];continue;case 7:r=c.ops.pop(),c.trys.pop();continue;default:if(u=c.trys,!(u=u.length>0&&u[u.length-1])&&(6===r[0]||2===r[0])){c=0;continue}if(3===r[0]&&(!u||r[1]>u[0]&&r[1]<u[3])){c.label=r[1];break}if(6===r[0]&&c.label<u[1]){c.label=u[1],u=r;break}if(u&&c.label<u[2]){c.label=u[2],c.ops.push(r);break}u[2]&&c.ops.pop(),c.trys.pop();continue}r=e.call(t,c)}catch(t){r=[6,t],i=0}finally{o=u=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}var o,i,u,a,c={label:0,sent:function(){if(1&u[0])throw u[1];return u[1]},trys:[],ops:[]};return a={next:r(0),throw:r(1),return:r(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a}function o(t){var e="function"==typeof Symbol&&t[Symbol.iterator],r=0;return e?e.call(t):{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}}}function i(t,e){var r="function"==typeof Symbol&&t[Symbol.iterator];if(!r)return t;var n,o,i=r.call(t),u=[];try{for(;(void 0===e||e-- >0)&&!(n=i.next()).done;)u.push(n.value)}catch(t){o={error:t}}finally{try{n&&!n.done&&(r=i.return)&&r.call(i)}finally{if(o)throw o.error}}return u}function u(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(i(arguments[e]));return t}function a(t){return this instanceof a?(this.v=t,this):new a(t)}function c(t,e,r){function n(t){l[t]&&(f[t]=function(e){return new Promise(function(r,n){h.push([t,e,r,n])>1||o(t,e)})})}function o(t,e){try{i(l[t](e))}catch(t){s(h[0][3],t)}}function i(t){t.value instanceof a?Promise.resolve(t.value.v).then(u,c):s(h[0][2],t)}function u(t){o("next",t)}function c(t){o("throw",t)}function s(t,e){t(e),h.shift(),h.length&&o(h[0][0],h[0][1])}if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var f,l=r.apply(t,e||[]),h=[];return f={},n("next"),n("throw"),n("return"),f[Symbol.asyncIterator]=function(){return this},f}function s(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=t[Symbol.asyncIterator];return e?e.call(t):"function"==typeof o?o(t):t[Symbol.iterator]()}function f(t,e){return e={exports:{}},t(e,e.exports),e.exports}function l(t){var e=fr.call(t,hr),r=t[hr];try{t[hr]=void 0;var n=!0}catch(t){}var o=lr.call(t);return n&&(e?t[hr]=r:delete t[hr]),o}function h(t){return vr.call(t)}function p(t){return null==t?void 0===t?gr:yr:_r&&_r in Object(t)?pr(t):br(t)}function d(t){return null!=t&&"object"==typeof t}function v(t){return!0===t||!1===t||wr(t)&&mr(t)==jr}function b(t,e){return function(r){return t(e(r))}}function y(t){if(!wr(t)||mr(t)!=Ar)return!1;var e=$r(t);if(null===e)return!0;var r=Rr.call(e,"constructor")&&e.constructor;return"function"==typeof r&&r instanceof r&&kr.call(r)==zr}function g(t){return void 0===t}function _(){if(!arguments.length)return[];var t=arguments[0];return Tr(t)?t:[t]}function m(t){var e=typeof t;return null!=t&&("object"==e||"function"==e)}function w(t){if(!Nr(t))return!1;var e=mr(t);return e==Fr||e==Lr||e==Ir||e==Ur}function j(t){return!!Wr&&Wr in t}function x(t){if(null!=t){try{return Gr.call(t)}catch(t){}try{return t+""}catch(t){}}return""}function O(t){return!(!Nr(t)||Hr(t))&&(qr(t)?nn:Yr).test(Jr(t))}function P(t,e){return null==t?void 0:t[e]}function $(t,e){var r=un(t,e);return on(r)?r:void 0}function A(t,e,r){"__proto__"==e&&sn?sn(t,e,{configurable:!0,enumerable:!0,value:r,writable:!0}):t[e]=r}function E(t,e){return t===e||t!==t&&e!==e}function S(t,e,r){var n=t[e];pn.call(t,e)&&ln(n,r)&&(void 0!==r||e in t)||fn(t,e,r)}function k(t,e,r,n){var o=!r;r||(r={});for(var i=-1,u=e.length;++i<u;){var a=e[i],c=n?n(r[a],t[a],a,r,t):void 0;void 0===c&&(c=t[a]),o?fn(r,a,c):dn(r,a,c)}return r}function R(t){return t}function z(t,e,r){switch(r.length){case 0:return t.call(e);case 1:return t.call(e,r[0]);case 2:return t.call(e,r[0],r[1]);case 3:return t.call(e,r[0],r[1],r[2])}return t.apply(e,r)}function C(t,e,r){return e=gn(void 0===e?t.length-1:e,0),function(){for(var n=arguments,o=-1,i=gn(n.length-e,0),u=Array(i);++o<i;)u[o]=n[e+o];o=-1;for(var a=Array(e+1);++o<e;)a[o]=n[o];return a[e]=r(u),yn(t,this,a)}}function M(t){return function(){return t}}function D(t){var e=0,r=0;return function(){var n=Pn(),o=On-(n-r);if(r=n,o>0){if(++e>=xn)return arguments[0]}else e=0;return t.apply(void 0,arguments)}}function T(t,e){return En(_n(t,e,bn),t+"")}function B(t){return"number"==typeof t&&t>-1&&t%1==0&&t<=kn}function N(t){return null!=t&&Rn(t.length)&&!qr(t)}function I(t,e){return!!(e=null==e?Cn:e)&&("number"==typeof t||Mn.test(t))&&t>-1&&t%1==0&&t<e}function F(t,e,r){if(!Nr(r))return!1;var n=typeof e;return!!("number"==n?zn(r)&&Dn(e,r.length):"string"==n&&e in r)&&ln(r[e],t)}function L(t){return Sn(function(e,r){var n=-1,o=r.length,i=o>1?r[o-1]:void 0,u=o>2?r[2]:void 0;for(i=t.length>3&&"function"==typeof i?(o--,i):void 0,u&&Tn(r[0],r[1],u)&&(i=o<3?void 0:i,o=1),e=Object(e);++n<o;){var a=r[n];a&&t(e,a,n,i)}return e})}function U(t,e){for(var r=-1,n=Array(t);++r<t;)n[r]=e(r);return n}function q(t){return wr(t)&&mr(t)==In}function Q(){return!1}function V(t){return wr(t)&&Rn(t.length)&&!!Kn[mr(t)]}function W(t){return function(e){return t(e)}}function H(t,e){var r=Tr(t),n=!r&&Vn(t),o=!r&&!n&&Hn(t),i=!r&&!n&&!o&&to(t),u=r||n||o||i,a=u?Nn(t.length,String):[],c=a.length;for(var s in t)!e&&!ro.call(t,s)||u&&("length"==s||o&&("offset"==s||"parent"==s)||i&&("buffer"==s||"byteLength"==s||"byteOffset"==s)||Dn(s,c))||a.push(s);return a}function K(t){var e=t&&t.constructor;return t===("function"==typeof e&&e.prototype||oo)}function G(t){var e=[];if(null!=t)for(var r in Object(t))e.push(r);return e}function J(t){if(!Nr(t))return uo(t);var e=io(t),r=[];for(var n in t)("constructor"!=n||!e&&co.call(t,n))&&r.push(n);return r}function X(t){return zn(t)?no(t,!0):so(t)}function Y(t,e){for(var r=-1,n=e.length,o=t.length;++r<n;)t[o+r]=e[r];return t}function Z(t){return Tr(t)||Vn(t)||!!(_o&&t&&t[_o])}function tt(t,e,r,n,o){var i=-1,u=t.length;for(r||(r=mo),o||(o=[]);++i<u;){var a=t[i];e>0&&r(a)?e>1?tt(a,e-1,r,n,o):go(o,a):n||(o[o.length]=a)}return o}function et(t,e){for(var r=-1,n=null==t?0:t.length,o=Array(n);++r<n;)o[r]=e(t[r],r,t);return o}function rt(){this.__data__=[],this.size=0}function nt(t,e){for(var r=t.length;r--;)if(ln(t[r][0],e))return r;return-1}function ot(t){var e=this.__data__,r=Oo(e,t);return!(r<0)&&(r==e.length-1?e.pop():$o.call(e,r,1),--this.size,!0)}function it(t){var e=this.__data__,r=Oo(e,t);return r<0?void 0:e[r][1]}function ut(t){return Oo(this.__data__,t)>-1}function at(t,e){var r=this.__data__,n=Oo(r,t);return n<0?(++this.size,r.push([t,e])):r[n][1]=e,this}function ct(t){var e=-1,r=null==t?0:t.length;for(this.clear();++e<r;){var n=t[e];this.set(n[0],n[1])}}function st(){this.__data__=new Ro,this.size=0}function ft(t){var e=this.__data__,r=e.delete(t);return this.size=e.size,r}function lt(t){return this.__data__.get(t)}function ht(t){return this.__data__.has(t)}function pt(){this.__data__=Io?Io(null):{},this.size=0}function dt(t){var e=this.has(t)&&delete this.__data__[t];return this.size-=e?1:0,e}function vt(t){var e=this.__data__;if(Io){var r=e[t];return r===Uo?void 0:r}return Qo.call(e,t)?e[t]:void 0}function bt(t){var e=this.__data__;return Io?void 0!==e[t]:Ho.call(e,t)}function yt(t,e){var r=this.__data__;return this.size+=this.has(t)?0:1,r[t]=Io&&void 0===e?Go:e,this}function gt(t){var e=-1,r=null==t?0:t.length;for(this.clear();++e<r;){var n=t[e];this.set(n[0],n[1])}}function _t(){this.size=0,this.__data__={hash:new Xo,map:new(Bo||Ro),string:new Xo}}function mt(t){var e=typeof t;return"string"==e||"number"==e||"symbol"==e||"boolean"==e?"__proto__"!==t:null===t}function wt(t,e){var r=t.__data__;return Zo(e)?r["string"==typeof e?"string":"hash"]:r.map}function jt(t){var e=ti(this,t).delete(t);return this.size-=e?1:0,e}function xt(t){return ti(this,t).get(t)}function Ot(t){return ti(this,t).has(t)}function Pt(t,e){var r=ti(this,t),n=r.size;return r.set(t,e),this.size+=r.size==n?0:1,this}function $t(t){var e=-1,r=null==t?0:t.length;for(this.clear();++e<r;){var n=t[e];this.set(n[0],n[1])}}function At(t,e){var r=this.__data__;if(r instanceof Ro){var n=r.__data__;if(!Bo||n.length<ui-1)return n.push([t,e]),this.size=++r.size,this;r=this.__data__=new ii(n)}return r.set(t,e),this.size=r.size,this}function Et(t){var e=this.__data__=new Ro(t);this.size=e.size}function St(t){return this.__data__.set(t,si),this}function kt(t){return this.__data__.has(t)}function Rt(t){var e=-1,r=null==t?0:t.length;for(this.__data__=new ii;++e<r;)this.add(t[e])}function zt(t,e){for(var r=-1,n=null==t?0:t.length;++r<n;)if(e(t[r],r,t))return!0;return!1}function Ct(t,e){return t.has(e)}function Mt(t,e,r,n,o,i){var u=r&vi,a=t.length,c=e.length;if(a!=c&&!(u&&c>a))return!1;var s=i.get(t);if(s&&i.get(e))return s==e;var f=-1,l=!0,h=r&bi?new hi:void 0;for(i.set(t,e),i.set(e,t);++f<a;){var p=t[f],d=e[f];if(n)var v=u?n(d,p,f,e,t,i):n(p,d,f,t,e,i);if(void 0!==v){if(v)continue;l=!1;break}if(h){if(!pi(e,function(t,e){if(!di(h,e)&&(p===t||o(p,t,r,n,i)))return h.push(e)})){l=!1;break}}else if(p!==d&&!o(p,d,r,n,i)){l=!1;break}}return i.delete(t),i.delete(e),l}function Dt(t){var e=-1,r=Array(t.size);return t.forEach(function(t,n){r[++e]=[n,t]}),r}function Tt(t){var e=-1,r=Array(t.size);return t.forEach(function(t){r[++e]=t}),r}function Bt(t,e,r,n,o,i,u){switch(r){case Mi:if(t.byteLength!=e.byteLength||t.byteOffset!=e.byteOffset)return!1;t=t.buffer,e=e.buffer;case Ci:return!(t.byteLength!=e.byteLength||!i(new _i(t),new _i(e)));case Oi:case Pi:case Ei:return ln(+t,+e);case $i:return t.name==e.name&&t.message==e.message;case Si:case Ri:return t==e+"";case Ai:var a=mi;case ki:var c=n&ji;if(a||(a=wi),t.size!=e.size&&!c)return!1;var s=u.get(t);if(s)return s==e;n|=xi,u.set(t,e);var f=yi(a(t),a(e),n,o,i,u);return u.delete(t),f;case zi:if(Ti)return Ti.call(t)==Ti.call(e)}return!1}function Nt(t,e,r){var n=e(t);return Tr(t)?n:go(n,r(t))}function It(t,e){for(var r=-1,n=null==t?0:t.length,o=0,i=[];++r<n;){var u=t[r];e(u,r,t)&&(i[o++]=u)}return i}function Ft(){return[]}function Lt(t){if(!io(t))return Hi(t);var e=[];for(var r in Object(t))Gi.call(t,r)&&"constructor"!=r&&e.push(r);return e}function Ut(t){return zn(t)?no(t):Ji(t)}function qt(t){return Ni(t,Xi,Vi)}function Qt(t,e,r,n,o,i){var u=r&Zi,a=Yi(t),c=a.length;if(c!=Yi(e).length&&!u)return!1;for(var s=c;s--;){var f=a[s];if(!(u?f in e:eu.call(e,f)))return!1}var l=i.get(t);if(l&&i.get(e))return l==e;var h=!0;i.set(t,e),i.set(e,t);for(var p=u;++s<c;){f=a[s];var d=t[f],v=e[f];if(n)var b=u?n(v,d,f,e,t,i):n(d,v,f,t,e,i);if(!(void 0===b?d===v||o(d,v,r,n,i):b)){h=!1;break}p||(p="constructor"==f)}if(h&&!p){var y=t.constructor,g=e.constructor;y!=g&&"constructor"in t&&"constructor"in e&&!("function"==typeof y&&y instanceof y&&"function"==typeof g&&g instanceof g)&&(h=!1)}return i.delete(t),i.delete(e),h}function Vt(t,e,r,n,o,i){var u=Tr(t),a=Tr(e),c=u?mu:yu(t),s=a?mu:yu(e);c=c==_u?wu:c,s=s==_u?wu:s;var f=c==wu,l=s==wu,h=c==s;if(h&&Hn(t)){if(!Hn(e))return!1;u=!0,f=!1}if(h&&!f)return i||(i=new ci),u||to(t)?yi(t,e,r,n,o,i):Bi(t,e,c,r,n,o,i);if(!(r&gu)){var p=f&&xu.call(t,"__wrapped__"),d=l&&xu.call(e,"__wrapped__");if(p||d){var v=p?t.value():t,b=d?e.value():e;return i||(i=new ci),o(v,b,r,n,i)}}return!!h&&(i||(i=new ci),ru(t,e,r,n,o,i))}function Wt(t,e,r,n,o){return t===e||(null==t||null==e||!wr(t)&&!wr(e)?t!==t&&e!==e:Ou(t,e,r,n,Wt,o))}function Ht(t,e,r,n){var o=r.length,i=o,u=!n;if(null==t)return!i;for(t=Object(t);o--;){var a=r[o];if(u&&a[2]?a[1]!==t[a[0]]:!(a[0]in t))return!1}for(;++o<i;){a=r[o];var c=a[0],s=t[c],f=a[1];if(u&&a[2]){if(void 0===s&&!(c in t))return!1}else{var l=new ci;if(n)var h=n(s,f,c,t,e,l);if(!(void 0===h?Pu(f,s,$u|Au,n,l):h))return!1}}return!0}function Kt(t){return t===t&&!Nr(t)}function Gt(t){for(var e=Xi(t),r=e.length;r--;){var n=e[r],o=t[n];e[r]=[n,o,Su(o)]}return e}function Jt(t,e){return function(r){return null!=r&&(r[t]===e&&(void 0!==e||t in Object(r)))}}function Xt(t){var e=ku(t);return 1==e.length&&e[0][2]?Ru(e[0][0],e[0][1]):function(r){return r===t||Eu(r,t,e)}}function Yt(t){return"symbol"==typeof t||wr(t)&&mr(t)==Cu}function Zt(t,e){if(Tr(t))return!1;var r=typeof t;return!("number"!=r&&"symbol"!=r&&"boolean"!=r&&null!=t&&!Mu(t))||(Tu.test(t)||!Du.test(t)||null!=e&&t in Object(e))}function te(t,e){if("function"!=typeof t||null!=e&&"function"!=typeof e)throw new TypeError(Nu);var r=function(){var n=arguments,o=e?e.apply(this,n):n[0],i=r.cache;if(i.has(o))return i.get(o);var u=t.apply(this,n);return r.cache=i.set(o,u)||i,u};return r.cache=new(te.Cache||ii),r}function ee(t){var e=Iu(t,function(t){return r.size===Fu&&r.clear(),t}),r=e.cache;return e}function re(t){if("string"==typeof t)return t;if(Tr(t))return jo(t,re)+"";if(Mu(t))return Gu?Gu.call(t):"";var e=t+"";return"0"==e&&1/t==-Hu?"-0":e}function ne(t){return null==t?"":Ju(t)}function oe(t,e){return Tr(t)?t:Bu(t,e)?[t]:Wu(Xu(t))}function ie(t){if("string"==typeof t||Mu(t))return t;var e=t+"";return"0"==e&&1/t==-Zu?"-0":e}function ue(t,e){e=Yu(e,t);for(var r=0,n=e.length;null!=t&&r<n;)t=t[ta(e[r++])];return r&&r==n?t:void 0}function ae(t,e,r){var n=null==t?void 0:ea(t,e);return void 0===n?r:n}function ce(t,e){return null!=t&&e in Object(t)}function se(t,e,r){e=Yu(e,t);for(var n=-1,o=e.length,i=!1;++n<o;){var u=ta(e[n]);if(!(i=null!=t&&r(t,u)))break;t=t[u]}return i||++n!=o?i:!!(o=null==t?0:t.length)&&Rn(o)&&Dn(u,o)&&(Tr(t)||Vn(t))}function fe(t,e){return null!=t&&oa(t,e,na)}function le(t,e){return Bu(t)&&Su(e)?Ru(ta(t),e):function(r){var n=ra(r,t);return void 0===n&&n===e?ia(r,t):Pu(e,n,ua|aa)}}function he(t){return function(e){return null==e?void 0:e[t]}}function pe(t){return function(e){return ea(e,t)}}function de(t){return Bu(t)?sa(ta(t)):fa(t)}function ve(t){return"function"==typeof t?t:null==t?bn:"object"==typeof t?Tr(t)?ca(t[0],t[1]):zu(t):la(t)}function be(t){return function(e,r,n){for(var o=-1,i=Object(e),u=n(e),a=u.length;a--;){var c=u[t?a:++o];if(!1===r(i[c],c,i))break}return e}}function ye(t,e){return t&&va(t,e,Xi)}function ge(t,e){return function(r,n){if(null==r)return r;if(!zn(r))return t(r,n);for(var o=r.length,i=e?o:-1,u=Object(r);(e?i--:++i<o)&&!1!==n(u[i],i,u););return r}}function _e(t,e){var r=-1,n=zn(t)?Array(t.length):[];return _a(t,function(t,o,i){n[++r]=e(t,o,i)}),n}function me(t,e){return(Tr(t)?jo:ma)(t,ha(e,3))}function we(t,e){return wo(wa(t,e),1)}function je(t,e){var r={};return e=ha(e,3),ba(t,function(t,n,o){fn(r,n,e(t,n,o))}),r}function xe(t,e,r,n){var o=-1,i=null==t?0:t.length;for(n&&i&&(r=t[++o]);++o<i;)r=e(r,t[o],o,t);return r}function Oe(t,e,r,n,o){return o(t,function(t,o,i){r=n?(n=!1,t):e(r,t,o,i)}),r}function Pe(t,e,r){var n=Tr(t)?Oa:Pa,o=arguments.length<3;return n(t,ha(e,4),r,o,_a)}function $e(t,e){var r=-1,n=t.length;for(e||(e=Array(n));++r<n;)e[r]=t[r];return e}function Ae(){var t=arguments.length;if(!t)return[];for(var e=Array(t-1),r=arguments[0],n=t;n--;)e[n-1]=arguments[n];return go(Tr(r)?Xa(r):[r],wo(e,1))}function Ee(){}function Se(t,e,r){return t===t&&(void 0!==r&&(t=t<=r?t:r),void 0!==e&&(t=t>=e?t:e)),t}function ke(t){if("number"==typeof t)return t;if(Mu(t))return ec;if(Nr(t)){var e="function"==typeof t.valueOf?t.valueOf():t;t=Nr(e)?e+"":e}if("string"!=typeof t)return 0===t?t:+t;t=t.replace(rc,"");var r=oc.test(t);return r||ic.test(t)?uc(t.slice(2),r?2:8):nc.test(t)?ec:+t}function Re(t){if(!t)return 0===t?t:0;if((t=ac(t))===cc||t===-cc){return(t<0?-1:1)*sc}return t===t?t:0}function ze(t){var e=fc(t),r=e%1;return e===e?r?e-r:e:0}function Ce(t,e,r){return t=Xu(t),r=null==r?0:tc(lc(r),0,t.length),e=Ju(e),t.slice(r,r+e.length)==e}function Me(t){for(var e=[],i=1;i<arguments.length;i++)e[i-1]=arguments[i];return r(this,void 0,void 0,function(){var r,i,a,c,s,f,l,h,p;return n(this,function(n){switch(n.label){case 0:r=0,i=!0,n.label=1;case 1:n.trys.push([1,6,7,8]),a=o(t),c=a.next(),n.label=2;case 2:return c.done?[3,5]:(s=c.value,r++,[4,Ie(s).apply(void 0,u(e))]);case 3:if(!1===(f=n.sent()))return i=!1,[3,5];n.label=4;case 4:return c=a.next(),[3,2];case 5:return[3,8];case 6:return l=n.sent(),h={error:l},[3,8];case 7:try{c&&!c.done&&(p=a.return)&&p.call(a)}finally{if(h)throw h.error}return[7];case 8:return[2,{count:r,success:i}]}})})}function De(t,e){if(0===e.indexOf("//"))for(e=e.replace("//","/");!t.isRoot;)t=t.ctx.$parent.router;else for(0===e.indexOf("./")&&(e=e.replace("./","/"),t=t.ctx.$child.router);e&&e.match(/\/?\.\./i)&&!t.isRoot;)t=t.ctx.$parent.router,e=e.replace(/\/?\.\./i,"");return{router:t,path:e}}function Te(t){var e=t.router,r=t.path;return e.ctx.base+r}function Be(t){for(var e=t.router,r=t.path,n=e.ctx;n;){if(n.router.isNavigating(),n.$child?!hc(r,n.pathname):r!==n.pathname)return!1;r=r.substr(n.pathname.length)||"/",n=n.$child}return!0}function Ne(t){return!Mr(t)&&qr(t.then)}function Ie(t){var e=this;return void 0===t&&(t=Za),function(){for(var o=[],i=0;i<arguments.length;i++)o[i]=arguments[i];return r(e,void 0,void 0,function(){var e,r,i;return n(this,function(n){switch(n.label){case 0:return e=function(){return t.length===o.length+1?new Promise(function(e){t.apply(void 0,u(o,[e]))}):t.apply(void 0,u(o))},r=e(),Ne(r)?[4,r]:[3,2];case 1:return i=n.sent(),[3,3];case 2:i=r,n.label=3;case 3:return[2,i]}})})}}function Fe(t){return function(e){return c(this,arguments,function(){var r,o,i,u,c,f,l;return n(this,function(n){switch(n.label){case 0:return[4,a(Ie(t)(e))];case 1:if(!(r=n.sent())||!qr(r.next))return[3,17];n.label=2;case 2:n.trys.push([2,10,11,16]),o=s(r),n.label=3;case 3:return[4,a(o.next())];case 4:return i=n.sent(),!i.done?[4,a(i.value)]:[3,9];case 5:return u=n.sent(),[4,a(u)];case 6:return[4,n.sent()];case 7:n.sent(),n.label=8;case 8:return[3,3];case 9:return[3,16];case 10:return c=n.sent(),f={error:c},[3,16];case 11:return n.trys.push([11,,14,15]),i&&!i.done&&(l=o.return)?[4,a(l.call(o))]:[3,13];case 12:n.sent(),n.label=13;case 13:return[3,15];case 14:if(f)throw f.error;return[7];case 15:return[7];case 16:return[3,28];case 17:return Cr(r)?[4,a(Ie(r.beforeRender)())]:[3,26];case 18:return[4,n.sent()];case 19:return n.sent(),[4,a(Ie(r.afterRender)())];case 20:return[4,n.sent()];case 21:return n.sent(),[4,a(Ie(r.beforeDispose)())];case 22:return[4,n.sent()];case 23:return n.sent(),[4,a(Ie(r.afterDispose)())];case 24:return[4,n.sent()];case 25:return n.sent(),[3,28];case 26:return[4,r];case 27:n.sent(),n.label=28;case 28:return[2]}})})}}function Le(t){for(;!Mr(t);){if(!Mr(t.$router))return t.$router;t=t.$parentContext}return $c.head}function Ue(t){return"string"==typeof t||!Tr(t)&&wr(t)&&mr(t)==vc}function qe(t,e){for(var r,n=[],o=0,i=0,u="",a=e&&e.delimiter||jc,c=e&&e.delimiters||xc,s=!1;null!==(r=Oc.exec(t));){var f=r[0],l=r[1],h=r.index;if(u+=t.slice(i,h),i=h+f.length,l)u+=l[1],s=!0;else{var p="",d=t[i],v=r[2],b=r[3],y=r[4],g=r[5];if(!s&&u.length){var _=u.length-1;c.indexOf(u[_])>-1&&(p=u[_],u=u.slice(0,_))}u&&(n.push(u),u="",s=!1);var m=""!==p&&void 0!==d&&d!==p,w="+"===g||"*"===g,j="?"===g||"*"===g,x=p||a,O=b||y;n.push({name:v||o++,prefix:p,delimiter:x,optional:j,repeat:w,partial:m,pattern:O?He(O):"[^"+We(x)+"]+?"})}}return(u||i<t.length)&&n.push(u+t.substr(i)),n}function Qe(t,e){return Ve(qe(t,e))}function Ve(t){for(var e=new Array(t.length),r=0;r<t.length;r++)"object"==typeof t[r]&&(e[r]=new RegExp("^(?:"+t[r].pattern+")$"));return function(r,n){for(var o="",i=n&&n.encode||encodeURIComponent,u=0;u<t.length;u++){var a=t[u];if("string"!=typeof a){var c,s=r?r[a.name]:void 0;if(Array.isArray(s)){if(!a.repeat)throw new TypeError('Expected "'+a.name+'" to not repeat, but got array');if(0===s.length){if(a.optional)continue;throw new TypeError('Expected "'+a.name+'" to not be empty')}for(var f=0;f<s.length;f++){if(c=i(s[f]),!e[u].test(c))throw new TypeError('Expected all "'+a.name+'" to match "'+a.pattern+'"');o+=(0===f?a.prefix:a.delimiter)+c}}else if("string"!=typeof s&&"number"!=typeof s&&"boolean"!=typeof s){if(!a.optional)throw new TypeError('Expected "'+a.name+'" to be '+(a.repeat?"an array":"a string"));a.partial&&(o+=a.prefix)}else{if(c=i(String(s)),!e[u].test(c))throw new TypeError('Expected "'+a.name+'" to match "'+a.pattern+'", but got "'+c+'"');o+=a.prefix+c}}else o+=a}return o}}function We(t){return t.replace(/([.+*?=^!:${}()[\]|\/\\])/g,"\\$1")}function He(t){return t.replace(/([=!:$\/()])/g,"\\$1")}function Ke(t){return t&&t.sensitive?"":"i"}function Ge(t,e){if(!e)return t;var r=t.source.match(/\((?!\?)/g);if(r)for(var n=0;n<r.length;n++)e.push({name:n,prefix:null,delimiter:null,optional:!1,repeat:!1,partial:!1,pattern:null});return t}function Je(t,e,r){for(var n=[],o=0;o<t.length;o++)n.push(Ze(t[o],e,r).source);return new RegExp("(?:"+n.join("|")+")",Ke(r))}function Xe(t,e,r){return Ye(qe(t,r),e,r)}function Ye(t,e,r){r=r||{};for(var n=r.strict,o=!1!==r.end,i=We(r.delimiter||jc),u=r.delimiters||xc,a=[].concat(r.endsWith||[]).map(We).concat("$").join("|"),c="",s=!1,f=0;f<t.length;f++){var l=t[f];if("string"==typeof l)c+=We(l),s=f===t.length-1&&u.indexOf(l[l.length-1])>-1;else{var h=We(l.prefix),p=l.repeat?"(?:"+l.pattern+")(?:"+h+"(?:"+l.pattern+"))*":l.pattern;e&&e.push(l),l.optional?l.partial?c+=h+"("+p+")?":c+="(?:"+h+"("+p+"))?":c+=h+"("+p+")"}}return o?(n||(c+="(?:"+i+")?"),c+="$"===a?"$":"(?="+a+")"):(n||(c+="(?:"+i+"(?="+a+"))?"),s||(c+="(?="+i+"|"+a+")")),new RegExp("^"+c,Ke(r))}function Ze(t,e,r){return t instanceof RegExp?Ge(t,e):Array.isArray(t)?Je(t,e,r):Xe(t,e,r)}function tr(t){var e=$c.head;if(e)for(;e.bound;)e=e.ctx.$child.router;else e=new $c($c.getPathFromLocation(),void 0,t);if(e.bound=!0,e.isRoot)e.ctx.runBeforeRender().then(function(){e.ctx._redirect?e.ctx.runAfterRender().then(function(){var t=De(e,e.ctx._redirect),r=t.router,n=t.path;r.update(n,e.ctx._redirectArgs).catch(function(t){return pc.error("Error redirecting",t)})}).catch(function(t){return pc.error("Error in afterRender middleware",t)}):(e.ctx.render(),wa($c.onInit,function(t){return t(e)}))}).catch(function(t){return pc.error("Error in beforeRender middleware",t)});else if(e.ctx._redirect){var r=De(e,e.ctx._redirect),n=r.router,o=r.path;setTimeout(function(){return n.update(o,e.ctx._redirectArgs)})}return e}var er="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},rr="object"==typeof er&&er&&er.Object===Object&&er,nr=rr,or="object"==typeof self&&self&&self.Object===Object&&self,ir=nr||or||Function("return this")(),ur=ir,ar=ur.Symbol,cr=ar,sr=Object.prototype,fr=sr.hasOwnProperty,lr=sr.toString,hr=cr?cr.toStringTag:void 0,pr=l,dr=Object.prototype,vr=dr.toString,br=h,yr="[object Null]",gr="[object Undefined]",_r=cr?cr.toStringTag:void 0,mr=p,wr=d,jr="[object Boolean]",xr=v,Or=b,Pr=Or(Object.getPrototypeOf,Object),$r=Pr,Ar="[object Object]",Er=Function.prototype,Sr=Object.prototype,kr=Er.toString,Rr=Sr.hasOwnProperty,zr=kr.call(Object),Cr=y,Mr=g,Dr=Array.isArray,Tr=Dr,Br=_,Nr=m,Ir="[object AsyncFunction]",Fr="[object Function]",Lr="[object GeneratorFunction]",Ur="[object Proxy]",qr=w,Qr=ur["__core-js_shared__"],Vr=Qr,Wr=function(){var t=/[^.]+$/.exec(Vr&&Vr.keys&&Vr.keys.IE_PROTO||"");return t?"Symbol(src)_1."+t:""}(),Hr=j,Kr=Function.prototype,Gr=Kr.toString,Jr=x,Xr=/[\\^$.*+?()[\]{}|]/g,Yr=/^\[object .+?Constructor\]$/,Zr=Function.prototype,tn=Object.prototype,en=Zr.toString,rn=tn.hasOwnProperty,nn=RegExp("^"+en.call(rn).replace(Xr,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),on=O,un=P,an=$,cn=function(){try{var t=an(Object,"defineProperty");return t({},"",{}),t}catch(t){}}(),sn=cn,fn=A,ln=E,hn=Object.prototype,pn=hn.hasOwnProperty,dn=S,vn=k,bn=R,yn=z,gn=Math.max,_n=C,mn=M,wn=sn?function(t,e){return sn(t,"toString",{configurable:!0,enumerable:!1,value:mn(e),writable:!0})}:bn,jn=wn,xn=800,On=16,Pn=Date.now,$n=D,An=$n(jn),En=An,Sn=T,kn=9007199254740991,Rn=B,zn=N,Cn=9007199254740991,Mn=/^(?:0|[1-9]\d*)$/,Dn=I,Tn=F,Bn=L,Nn=U,In="[object Arguments]",Fn=q,Ln=Object.prototype,Un=Ln.hasOwnProperty,qn=Ln.propertyIsEnumerable,Qn=Fn(function(){return arguments}())?Fn:function(t){return wr(t)&&Un.call(t,"callee")&&!qn.call(t,"callee")},Vn=Qn,Wn=Q,Hn=f(function(t,e){var r=e&&!e.nodeType&&e,n=r&&!0&&t&&!t.nodeType&&t,o=n&&n.exports===r,i=o?ur.Buffer:void 0,u=i?i.isBuffer:void 0,a=u||Wn;t.exports=a}),Kn={};Kn["[object Float32Array]"]=Kn["[object Float64Array]"]=Kn["[object Int8Array]"]=Kn["[object Int16Array]"]=Kn["[object Int32Array]"]=Kn["[object Uint8Array]"]=Kn["[object Uint8ClampedArray]"]=Kn["[object Uint16Array]"]=Kn["[object Uint32Array]"]=!0,Kn["[object Arguments]"]=Kn["[object Array]"]=Kn["[object ArrayBuffer]"]=Kn["[object Boolean]"]=Kn["[object DataView]"]=Kn["[object Date]"]=Kn["[object Error]"]=Kn["[object Function]"]=Kn["[object Map]"]=Kn["[object Number]"]=Kn["[object Object]"]=Kn["[object RegExp]"]=Kn["[object Set]"]=Kn["[object String]"]=Kn["[object WeakMap]"]=!1;var Gn=V,Jn=W,Xn=f(function(t,e){var r=e&&!e.nodeType&&e,n=r&&!0&&t&&!t.nodeType&&t,o=n&&n.exports===r,i=o&&nr.process,u=function(){try{return i&&i.binding&&i.binding("util")}catch(t){}}();t.exports=u}),Yn=Xn&&Xn.isTypedArray,Zn=Yn?Jn(Yn):Gn,to=Zn,eo=Object.prototype,ro=eo.hasOwnProperty,no=H,oo=Object.prototype,io=K,uo=G,ao=Object.prototype,co=ao.hasOwnProperty,so=J,fo=X,lo=Bn(function(t,e){vn(e,fo(e),t)}),ho=lo,po=ho,vo=Bn(function(t,e,r,n){vn(e,fo(e),t,n)}),bo=vo,yo=bo,go=Y,_o=cr?cr.isConcatSpreadable:void 0,mo=Z,wo=tt,jo=et,xo=rt,Oo=nt,Po=Array.prototype,$o=Po.splice,Ao=ot,Eo=it,So=ut,ko=at;ct.prototype.clear=xo,ct.prototype.delete=Ao,ct.prototype.get=Eo,ct.prototype.has=So,ct.prototype.set=ko;var Ro=ct,zo=st,Co=ft,Mo=lt,Do=ht,To=an(ur,"Map"),Bo=To,No=an(Object,"create"),Io=No,Fo=pt,Lo=dt,Uo="__lodash_hash_undefined__",qo=Object.prototype,Qo=qo.hasOwnProperty,Vo=vt,Wo=Object.prototype,Ho=Wo.hasOwnProperty,Ko=bt,Go="__lodash_hash_undefined__",Jo=yt;gt.prototype.clear=Fo,gt.prototype.delete=Lo,gt.prototype.get=Vo,gt.prototype.has=Ko,gt.prototype.set=Jo;var Xo=gt,Yo=_t,Zo=mt,ti=wt,ei=jt,ri=xt,ni=Ot,oi=Pt;$t.prototype.clear=Yo,$t.prototype.delete=ei,$t.prototype.get=ri,$t.prototype.has=ni,$t.prototype.set=oi;var ii=$t,ui=200,ai=At;Et.prototype.clear=zo,Et.prototype.delete=Co,Et.prototype.get=Mo,Et.prototype.has=Do,Et.prototype.set=ai;var ci=Et,si="__lodash_hash_undefined__",fi=St,li=kt;Rt.prototype.add=Rt.prototype.push=fi,Rt.prototype.has=li;var hi=Rt,pi=zt,di=Ct,vi=1,bi=2,yi=Mt,gi=ur.Uint8Array,_i=gi,mi=Dt,wi=Tt,ji=1,xi=2,Oi="[object Boolean]",Pi="[object Date]",$i="[object Error]",Ai="[object Map]",Ei="[object Number]",Si="[object RegExp]",ki="[object Set]",Ri="[object String]",zi="[object Symbol]",Ci="[object ArrayBuffer]",Mi="[object DataView]",Di=cr?cr.prototype:void 0,Ti=Di?Di.valueOf:void 0,Bi=Bt,Ni=Nt,Ii=It,Fi=Ft,Li=Object.prototype,Ui=Li.propertyIsEnumerable,qi=Object.getOwnPropertySymbols,Qi=qi?function(t){return null==t?[]:(t=Object(t),Ii(qi(t),function(e){return Ui.call(t,e)}))}:Fi,Vi=Qi,Wi=Or(Object.keys,Object),Hi=Wi,Ki=Object.prototype,Gi=Ki.hasOwnProperty,Ji=Lt,Xi=Ut,Yi=qt,Zi=1,tu=Object.prototype,eu=tu.hasOwnProperty,ru=Qt,nu=an(ur,"DataView"),ou=nu,iu=an(ur,"Promise"),uu=iu,au=an(ur,"Set"),cu=au,su=an(ur,"WeakMap"),fu=su,lu=Jr(ou),hu=Jr(Bo),pu=Jr(uu),du=Jr(cu),vu=Jr(fu),bu=mr;(ou&&"[object DataView]"!=bu(new ou(new ArrayBuffer(1)))||Bo&&"[object Map]"!=bu(new Bo)||uu&&"[object Promise]"!=bu(uu.resolve())||cu&&"[object Set]"!=bu(new cu)||fu&&"[object WeakMap]"!=bu(new fu))&&(bu=function(t){var e=mr(t),r="[object Object]"==e?t.constructor:void 0,n=r?Jr(r):"";if(n)switch(n){case lu:return"[object DataView]";case hu:return"[object Map]";case pu:return"[object Promise]";case du:return"[object Set]";case vu:return"[object WeakMap]"}return e});var yu=bu,gu=1,_u="[object Arguments]",mu="[object Array]",wu="[object Object]",ju=Object.prototype,xu=ju.hasOwnProperty,Ou=Vt,Pu=Wt,$u=1,Au=2,Eu=Ht,Su=Kt,ku=Gt,Ru=Jt,zu=Xt,Cu="[object Symbol]",Mu=Yt,Du=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,Tu=/^\w*$/,Bu=Zt,Nu="Expected a function";te.Cache=ii;var Iu=te,Fu=500,Lu=ee,Uu=/^\./,qu=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,Qu=/\\(\\)?/g,Vu=Lu(function(t){var e=[];return Uu.test(t)&&e.push(""),t.replace(qu,function(t,r,n,o){e.push(n?o.replace(Qu,"$1"):r||t)}),e}),Wu=Vu,Hu=1/0,Ku=cr?cr.prototype:void 0,Gu=Ku?Ku.toString:void 0,Ju=re,Xu=ne,Yu=oe,Zu=1/0,ta=ie,ea=ue,ra=ae,na=ce,oa=se,ia=fe,ua=1,aa=2,ca=le,sa=he,fa=pe,la=de,ha=ve,pa=be,da=pa(),va=da,ba=ye,ya=ge,ga=ya(ba),_a=ga,ma=_e,wa=me,ja=we,xa=je,Oa=xe,Pa=Oe,$a=Pe,Aa=f(function(t){var e=t.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=e)}),Ea=f(function(t){var e=t.exports={version:"2.5.1"};"number"==typeof __e&&(__e=e)}),Sa=(Ea.version,Aa["__core-js_shared__"]||(Aa["__core-js_shared__"]={})),ka=function(t){return Sa[t]||(Sa[t]={})},Ra=0,za=Math.random(),Ca=function(t){return"Symbol(".concat(void 0===t?"":t,")_",(++Ra+za).toString(36))},Ma=f(function(t){var e=ka("wks"),r=Aa.Symbol,n="function"==typeof r;(t.exports=function(t){return e[t]||(e[t]=n&&r[t]||(n?r:Ca)("Symbol."+t))}).store=e}),Da=Ma,Ta={f:Da},Ba=function(t){return"object"==typeof t?null!==t:"function"==typeof t},Na=function(t){if(!Ba(t))throw TypeError(t+" is not an object!");return t},Ia=function(t){try{return!!t()}catch(t){return!0}},Fa=!Ia(function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a}),La=Aa.document,Ua=Ba(La)&&Ba(La.createElement),qa=function(t){return Ua?La.createElement(t):{}},Qa=!Fa&&!Ia(function(){return 7!=Object.defineProperty(qa("div"),"a",{get:function(){return 7}}).a}),Va=function(t,e){if(!Ba(t))return t;var r,n;if(e&&"function"==typeof(r=t.toString)&&!Ba(n=r.call(t)))return n;if("function"==typeof(r=t.valueOf)&&!Ba(n=r.call(t)))return n;if(!e&&"function"==typeof(r=t.toString)&&!Ba(n=r.call(t)))return n;throw TypeError("Can't convert object to primitive value")},Wa=Object.defineProperty,Ha=Fa?Object.defineProperty:function(t,e,r){if(Na(t),e=Va(e,!0),Na(r),Qa)try{return Wa(t,e,r)}catch(t){}if("get"in r||"set"in r)throw TypeError("Accessors not supported!");return"value"in r&&(t[e]=r.value),t},Ka={f:Ha},Ga=Ka.f,Ja=function(t){var e=Ea.Symbol||(Ea.Symbol=Aa.Symbol||{});"_"==t.charAt(0)||t in e||Ga(e,t,{value:Ta.f(t)})};Ja("asyncIterator"),Ja("observable");var Xa=(Ea.Symbol,$e),Ya=Ae,Za=Ee,tc=Se,ec=NaN,rc=/^\s+|\s+$/g,nc=/^[-+]0x[0-9a-f]+$/i,oc=/^0b[01]+$/i,ic=/^0o[0-7]+$/i,uc=parseInt,ac=ke,cc=1/0,sc=1.7976931348623157e308,fc=Re,lc=ze,hc=Ce,pc={error:function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];console.error.apply(console,u(["[@profiscience/knockout-contrib-router]"],t))}},dc=function(){function t(t,e,r,n){void 0===n&&(n={}),this._queue=[],this._beforeNavigateCallbacks=[],this._appMiddlewareDownstream=[],this._routeMiddlewareDownstream=[];var o=t.resolveRoute(r),i=o.parse(r),u=i.params,a=i.pathname,c=i.childPath;po(this,{$parent:e,params:u,path:r,pathname:a,route:o,router:t},n),e&&(e.$child=this),c&&new $c(c,this).ctx}return t.prototype.addBeforeNavigateCallback=function(t){this._beforeNavigateCallbacks.unshift(t)},Object.defineProperty(t.prototype,"base",{get:function(){
return this.router.isRoot?$c.base:this.$parent.base+this.$parent.pathname},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"canonicalPath",{get:function(){return this.base.replace(new RegExp(this.$root.base,"i"),"")+this.pathname},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"element",{get:function(){return this._redirect?void 0:document.getElementsByClassName("router-view")[this.$parents.length]},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"$root",{get:function(){for(var t=this;t;){if(!t.$parent)return t;t=t.$parent}},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"$parents",{get:function(){for(var t=[],e=this.$parent;e;)t.push(e),e=e.$parent;return t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"$children",{get:function(){for(var t=[],e=this.$child;e;)t.push(e),e=e.$child;return t},enumerable:!0,configurable:!0}),t.prototype.queue=function(t){this._queue.push(t)},t.prototype.redirect=function(t,e){void 0===e&&(e={}),this._redirect=t,this._redirectArgs=po({},e,{push:!1})},t.prototype.runBeforeNavigateCallbacks=function(){return r(this,void 0,void 0,function(){var t,e,r;return n(this,function(n){switch(n.label){case 0:for(t=this,e=[];t;)e=u(t._beforeNavigateCallbacks,e),t=t.$child;return[4,Me(e)];case 1:return r=n.sent().success,[2,r]}})})},t.prototype.render=function(){for(var t=this;t;)Mr(t._redirect)&&t.router.component(t.route.component),t=t.$child;e.tasks.runEarly()},t.prototype.runBeforeRender=function(e){return void 0===e&&(e=!0),r(this,void 0,void 0,function(){var r,o,i,u;return n(this,function(n){switch(n.label){case 0:return r=t.runMiddleware($c.middleware,this),o=t.runMiddleware(this.route.middleware,this),[4,Me(r)];case 1:return i=n.sent().count,[4,Me(o)];case 2:return u=n.sent().count,this._appMiddlewareDownstream=r.slice(0,i),this._routeMiddlewareDownstream=o.slice(0,u),this.$child&&Mr(this._redirect)?[4,this.$child.runBeforeRender(!1)]:[3,4];case 3:n.sent(),n.label=4;case 4:return e?[4,this.flushQueue()]:[3,6];case 5:n.sent(),n.label=6;case 6:return[2]}})})},t.prototype.runAfterRender=function(){return r(this,void 0,void 0,function(){return n(this,function(t){switch(t.label){case 0:return[4,Me(Ya(this._appMiddlewareDownstream,this._routeMiddlewareDownstream))];case 1:return t.sent(),[4,this.flushQueue()];case 2:return t.sent(),[2]}})})},t.prototype.runBeforeDispose=function(t){return void 0===t&&(t=!0),r(this,void 0,void 0,function(){return n(this,function(e){switch(e.label){case 0:return this.$child&&Mr(this._redirect)?[4,this.$child.runBeforeDispose(!1)]:[3,2];case 1:e.sent(),e.label=2;case 2:return[4,Me(Ya(this._routeMiddlewareDownstream,this._appMiddlewareDownstream))];case 3:return e.sent(),t?[4,this.flushQueue()]:[3,5];case 4:e.sent(),e.label=5;case 5:return[2]}})})},t.prototype.runAfterDispose=function(t){return void 0===t&&(t=!0),r(this,void 0,void 0,function(){return n(this,function(e){switch(e.label){case 0:return this.$child&&Mr(this._redirect)?[4,this.$child.runAfterDispose(!1)]:[3,2];case 1:e.sent(),e.label=2;case 2:return[4,Me(Ya(this._routeMiddlewareDownstream,this._appMiddlewareDownstream))];case 3:return e.sent(),t?[4,this.flushQueue()]:[3,5];case 4:e.sent(),e.label=5;case 5:return[2]}})})},t.prototype.flushQueue=function(){return r(this,void 0,void 0,function(){var t,e,r=this;return n(this,function(n){switch(n.label){case 0:return t=Promise.all(this._queue).then(function(){r._queue=[]}),e=wa(this.$children,function(t){return t.flushQueue()}),[4,Promise.all(u([t],e))];case 1:return n.sent(),[2]}})})},t.runMiddleware=function(t,e){var o=this;return wa(t,function(t){var i=Fe(t)(e),u=!0;return function(){return r(o,void 0,void 0,function(){var t;return n(this,function(r){switch(r.label){case 0:return t=i.next(),Ne(t)?[4,t]:[3,2];case 1:return r.sent(),[3,4];case 2:return Ne(t.value)?[4,t.value]:[3,4];case 3:r.sent(),r.label=4;case 4:return u?(u=!1,[2,Mr(e._redirect)]):[2,!0]}})})}})},t}(),vc="[object String]",bc=Ue,yc=Ze,gc=qe,_c=Qe,mc=Ve,wc=Ye,jc="/",xc="./",Oc=new RegExp(["(\\\\.)","(?:\\:(\\w+)(?:\\(((?:\\\\.|[^\\\\()])+)\\))?|\\(((?:\\\\.|[^\\\\()])+)\\))([+*?])?"].join("|"),"g");yc.parse=gc,yc.compile=_c,yc.tokensToFunction=mc,yc.tokensToRegExp=wc;var Pc=function(){function t(e,r){var n=i(t.parseConfig(r),3),o=n[0],u=n[1],a=n[2];this.path=e,this.component=o,this.middleware=u,this.children=a;var c=t.parsePath(e,!Mr(a)),s=c.keys,f=c.regexp;this.keys=s,this.regexp=f}return t.prototype.matches=function(t){var e=this.regexp.exec(t);if(null===e)return!1;if(this.children){try{for(var r=o(this.children),n=r.next();!n.done;n=r.next()){var i=n.value,u="/"+(e[e.length-1]||"");if(i.matches(u))return!0}}catch(t){a={error:t}}finally{try{n&&!n.done&&(c=r.return)&&c.call(r)}finally{if(a)throw a.error}}return!1}return!0;var a,c},t.prototype.parse=function(t){for(var e,r=t,n={},o=this.regexp.exec(t),i=1,u=o.length;i<u;++i){var a=this.keys[i-1],c=o[i]||"";"__child_path__"===a.name?(e="/"+c,r=t.replace(new RegExp(e+"$"),"")):n[a.name]=c}return{params:n,pathname:r,childPath:e}},t.parseConfig=function(e){var r,n,o=$a(e,function(e,o){return bc(o)?(o=o,r=o):Cr(o)?(o=o,n=wa(o,function(e,r){return new t(r,e)}),r||(r="router")):qr(o)&&(o=o,e.push(o)),e},[]);return[r,o,n]},t.parsePath=function(t,e){e&&(t=t.replace(/\/?!?$/,"/!")),t="!"===t[t.length-1]?t.replace("!",":__child_path__(.*)?"):t.replace(/\(?\*\)?/,"(.*)");var r=[];return{keys:r,regexp:yc(t,r)}},t}(),$c=function(){function t(r,n,o){void 0===o&&(o={}),this.onInit=[],this.component=e.observable(null),this.isNavigating=e.observable(!0),this.isRoot=Mr(n),this.routes=this.isRoot?t.createRoutes(t.routes):n.route.children,this.isRoot&&(t.head=this,document.addEventListener(t.events.click,t.onclick),window.addEventListener(t.events.popstate,t.onpopstate)),this.ctx=new dc(this,n,t.getPath(r),o)}return Object.defineProperty(t.prototype,"initialized",{get:function(){var t=this;return this.isNavigating()?new Promise(function(e){return t.onInit.push(e)}):Promise.resolve(this)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"depth",{get:function(){return this.ctx.$parents.length},enumerable:!0,configurable:!0}),t.prototype.init=function(){var t=this;this.isNavigating(!1),this.ctx.runAfterRender().then(function(){for(var e=t.ctx;e;)wa(e.router.onInit,function(t){return function(e){return e(t)}}(e.router)),e=e.$child}).catch(function(t){return pc.error("Error initializing router",t)})},t.prototype.update=function(o,i){return r(this,void 0,void 0,function(){var r,u,a,c,s,f,l,h,p,d,v,b,y,g,_,m;return n(this,function(n){switch(n.label){case 0:return r=xr(i)?{push:i}:Mr(i)?{}:i,Mr(r.push)&&(r.push=!0),Mr(r.with)&&(r.with={}),u=this.ctx,a=t.parseUrl(o),c=a.search,s=a.hash,f=t.getPath(o),l=this.resolveRoute(f),h=l.parse(f),p=h.pathname,d=h.childPath,v=u.pathname===p,u.$child&&v&&!r.force?[4,u.$child.router.update(d+c+s,r)]:[3,2];case 1:return[2,n.sent()];case 2:return b=new dc(this,this.ctx.$parent,f,r.with),b.route?[4,u.runBeforeNavigateCallbacks()]:[2,!1];case 3:return!1===(y=n.sent())?[2,!1]:(this.isNavigating(!0),[4,u.runBeforeDispose()]);case 4:return n.sent(),history[r.push?"pushState":"replaceState"](history.state,document.title,b.base+b.path+c+s),[4,b.runBeforeRender()];case 5:return n.sent(),Mr(b._redirect)&&(this.component(null),e.tasks.runEarly()),this.ctx=b,[4,u.runAfterDispose()];case 6:return n.sent(),b.render(),Mr(b._redirect)?[3,8]:[4,b.runAfterRender()];case 7:n.sent(),g=De(b.router,b._redirect),_=g.router,m=g.path,_.update(m,b._redirectArgs).catch(function(t){return pc.error("Error redirecting",t)}),n.label=8;case 8:return[2,!0]}})})},t.prototype.resolveRoute=function(t){var e,r=1/0;for(var n in this.routes)if(this.routes.hasOwnProperty(n)){var o=this.routes[n];if(o.matches(t)){if(0===o.keys.length)return o;(r===1/0||o.keys.length<r&&".*"!==o.keys[0].pattern)&&(r=o.keys.length,e=o)}}return e},t.prototype.dispose=function(){this.isRoot&&(document.removeEventListener(t.events.click,t.onclick,!1),window.removeEventListener(t.events.popstate,t.onpopstate,!1),delete t.head)},Object.defineProperty(t,"initialized",{get:function(){var e=this;return t.head?Promise.resolve(t.head):new Promise(function(t){return e.onInit.push(t)})},enumerable:!0,configurable:!0}),Object.defineProperty(t,"base",{get:function(){return t.config.base+(t.config.hashbang?"/#!":"")},enumerable:!0,configurable:!0}),t.setConfig=function(e){var r=e.base,n=e.hashbang,o=e.activePathCSSClass;return yo(t.config,{base:r,hashbang:n,activePathCSSClass:o},function(t,e){return Mr(e)?t:e}),this},t.use=function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];return(n=t.middleware).push.apply(n,u(e)),this;var n},t.usePlugin=function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];return(n=t.plugins).push.apply(n,u(e)),this;var n},t.useRoutes=function(e){return po(t.routes,t.normalizeRoutes(e)),this},t.get=function(e){for(var r=t.head;e-- >0;)r=r.ctx.$child.router;return r},t.update=function(e,o){return r(this,void 0,void 0,function(){return n(this,function(r){switch(r.label){case 0:return[4,t.head.update(e,o)];case 1:return[2,r.sent()]}})})},t.getPathFromLocation=function(){var e=location.pathname+location.search+location.hash,r=t.config.base.replace("#!","#?!?");return e.replace(new RegExp(r,"i"),"")},t.onclick=function(e){if(!e.defaultPrevented){for(var r=e.target;r&&"A"!==r.nodeName;)r=r.parentNode;if(r&&"A"===r.nodeName){var n=r.pathname,o=r.search,i=r.hash,u=void 0===i?"":i,a=(n+o+u).replace(new RegExp(t.base,"i"),""),c=t.hasRoute(a),s=!t.sameOrigin(r.href),f=1!==t.which(e),l=r.hasAttribute("download"),h="#"===r.getAttribute("href"),p=0===(r.getAttribute("href")||"").indexOf("mailto:"),d="external"===r.getAttribute("rel"),v=e.metaKey||e.ctrlKey||e.shiftKey,b=r.hasAttribute("target");!c||s||f||l||h||p||d||v||b||(t.update(a).catch(function(t){return pc.error("Error occured during navigation",t)}),e.preventDefault())}}},t.onpopstate=function(e){t.update(t.getPathFromLocation(),!1).catch(function(t){return pc.error("Error navigating back",t)}),e.preventDefault()},t.canonicalizePath=function(t){return t.replace(new RegExp("/?#?!?/?"),"/")},t.parseUrl=function(e){var r=document.createElement("a"),n=t.base.toLowerCase();return n&&0===e.toLowerCase().indexOf(n)&&(e=e.replace(new RegExp(n,"i"),"")||"/"),r.href=t.canonicalizePath(e),{hash:r.hash,pathname:"/"===r.pathname.charAt(0)?r.pathname:"/"+r.pathname,search:r.search}},t.getPath=function(e){return t.parseUrl(e).pathname},t.hasRoute=function(e){return!Mr(t.head.resolveRoute(t.getPath(e)))},t.createRoutes=function(t){return wa(t,function(t,e){return new Pc(e,t)})},t.normalizeRoutes=function(e){return xa(e,function(e){return wa(t.runPlugins(e),function(e){return Cr(e)?t.normalizeRoutes(e):e})})},t.runPlugins=function(e){return ja(Br(e),function(e){var r=$a(t.plugins,function(t,r){var n=r(e);return Mr(n)?t:t.concat(Br(n))},[]);return r.length>0?r:e})},t.sameOrigin=function(t){var e=location.hostname,r=location.port,n=location.protocol,o=n+"//"+e;return r&&(o+=":"+r),t&&0===t.indexOf(o)},t.which=function(t){return t=t||window.event,null===t.which?t.button:t.which},t.onInit=[],t.middleware=[],t.plugins=[],t.config={base:"",hashbang:!1,activePathCSSClass:"active-path"},t.routes={},t.events={click:document.ontouchstart?"touchstart":"click",popstate:"popstate"},t}(),Ac={init:function(t,r,n,o,i){var u=n.get("pathActiveClass")||$c.config.activePathCSSClass,a=e.unwrap(r());$c.initialized.then(function(){var r=Le(i),n=e.pureComputed(function(){return De(r,a)});e.applyBindingsToNode(t,{css:(o={},o[u]=e.pureComputed(function(){return Be(n())}),o)});var o}).catch(function(t){return pc.error("Error initializing activePath binding",t)})}};e.bindingHandlers.activePath=Ac;var Ec={init:function(t,r,n,o,i){var u=e.unwrap(r());Ac.init.apply(this,arguments),$c.initialized.then(function(){var r=Le(i),n=e.pureComputed(function(){return De(r,u)});e.applyBindingsToNode(t,{attr:{href:e.pureComputed(function(){return Te(n())})}})}).catch(function(t){return pc.error("Error initializing path binding",t)})}};e.bindingHandlers.path=Ec,e.components.register("router",{synchronous:!0,viewModel:{createViewModel:tr},template:'<div data-bind="if: component">\n      <div class="router-view" data-bind="__router__"></div>\n    </div>'}),e.bindingHandlers.__router__={init:function(t,r,n,o,i){var u=i.$rawData;return e.applyBindingsToNode(t,{css:u.component,component:{name:u.component,params:u.ctx}},i.extend({$router:u})),u.isRoot?u.init():u.ctx.$parent.router.initialized.then(function(){return u.init()}).catch(Za),{controlsDescendantBindings:!0}}},t.Context=dc,t.Route=Pc,t.Router=$c,t.isActivePath=Be,t.resolveHref=Te,Object.defineProperty(t,"__esModule",{value:!0})});